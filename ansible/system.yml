---
- name: Setup new machine
  hosts: local
  become: yes

  tasks:
  - name: Setup basic system
    include_role:
      name: system

  - name: Install Fish and configure default shell
    include_role:
      name: fish
    vars:
      fish_users: ['root', 'cumpsd']

  - name: Install FZF
    include_role:
      name: fzf
    vars:
      fzf_version: '0.18.0'

  - name: Install Git from source
    include_role:
      name: git
    vars:
      git_packages:
      - git

      git_version: '2.21.0'
      git_install_from_source: true
      git_install_path: '/usr'
      git_install_from_source_force_update: true

  - name: Install Hub
    include_role:
      name: hub
    vars:
      hub_version: "2.11.1"

  - name: Install Pip
    include_role:
      name: pip
    vars:
      pip_install_packages:
      - pip
      - awscli
      - thefuck
      - boto
      - virtualfish

  - name: Install Node.js and NPM
    include_role:
      name: nodejs
    vars:
      nodejs_version: '10.x'
      nodejs_npm_global_packages:
      - npm
      - npx
      - yarn
      - eslint

  - name: Install Go
    include_role:
      name: golang
    vars:
      go_tarball: 'go1.12.2.linux-amd64.tar.gz'
      go_tarball_checksum: 'sha256:f28c1fde8f293cc5c83ae8de76373cf76ae9306909564f54e0edcf140ce8fe3f'
      go_version_target: 'go version go1.12.2 linux/amd64'

      go_packages:
      - 'github.com/cumpsd/ccat'

  - name: Install Docker and Docker-compose
    include_role:
      name: docker
    vars:
      docker_edition: 'ce'
      docker_package_state: latest
      docker_apt_release_channel: edge
      docker_service_state: stopped
      docker_service_enabled: no
      docker_restart_handler_state: stopped
      docker_install_compose: True
      docker_compose_version: '1.24.0'
      docker_compose_path: /usr/local/bin/docker-compose
      docker_users: ['cumpsd']

  # - include_role:
  #     name: dotnet-core
  #   vars:
  #     dotnet_package: 'dotnet-sdk-2.1'

  - name: Setup NTP and configure timezone
    include_role:
      name: ntp
    vars:
      ntp_enabled: true
      ntp_timezone: Europe/Brussels

  - name: Install Packer
    include_role:
      name: packer
    vars:
      packer_version: '1.3.5'

  - name: Install Terraform
    include_role:
      name: terraform
    vars:
      terraform_ver : '0.11.13'
      terraform_platform : linux_amd64
      terraform_install_dir : /usr/local/bin
      terraform_checksums:
        '0.11.13':
          linux_amd64: sha256:5925cd4d81e7d8f42a0054df2aafd66e2ab7408dbed2bd748f0022cfe592f8d2

  - name: Install Consul
    include_role:
      name: consul-cli
    vars:
      consul_ver : '1.4.4'
      consul_platform : linux_amd64
      consul_install_dir : /usr/local/bin
      consul_checksums:
        '1.4.4':
          linux_amd64: sha256:d3bdf9817c7de9d83426d8c421eb3f37bf82c03c97860ef78fb56e148c4a9765

  - name: Install Nomad
    include_role:
      name: nomad-cli
    vars:
      nomad_ver : '0.8.7'
      nomad_platform : linux_amd64
      nomad_install_dir : /usr/local/bin
      nomad_checksums:
        '0.8.7':
          linux_amd64: sha256:a5a3a507ee8048ab2337427824b5e7fd0c6c069ca5d2f545f13f742af0a707da

  - name: Install Vault
    include_role:
      name: vault-cli
    vars:
      vault_ver : '1.1.0'
      vault_platform : linux_amd64
      vault_install_dir : /usr/local/bin
      vault_checksums:
        '1.1.0':
          linux_amd64: sha256:65d665ee7ba08fb41a7113a2ae3c1d5fd7e0b530b59644ed7dc8a01870b2d73f

  - name: Install Mono
    include_role:
      name: mono

  # - name: Install Polybar
  #   include_role:
  #     name: polybar

  # - name: Install VS Code
  #   include_role:
  #     name: visual-studio-code
