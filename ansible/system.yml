---
- name: Setup new machine
  hosts: local
  become: yes

  tasks:
  - name: Setup basic system
    include_role:
      name: system

  - name: Install Fish and configure default shell
    include_role:
      name: fish
    vars:
      fish_users: ['root', 'cumpsd']

  - name: Install FZF
    include_role:
      name: fzf
    vars:
      fzf_version: '0.17.5'

  - name: Install Git from source
    include_role:
      name: git
    vars:
      git_packages:
      - git

      git_version: '2.19.2'
      git_install_from_source: true
      git_install_path: '/usr'
      git_install_from_source_force_update: true

  - name: Install Hub
    include_role:
      name: hub
    vars:
      hub_version: "2.6.0"

  - name: Install Pip
    include_role:
      name: pip
    vars:
      pip_install_packages:
      - pip
      - awscli
      - thefuck
      - boto
      - virtualfish

  - name: Install Node.js and NPM
    include_role:
      name: nodejs
    vars:
      nodejs_version: '10.x'
      nodejs_npm_global_packages:
      - npm
      - npx
      - yarn
      - eslint

  - name: Install Go
    include_role:
      name: golang
    vars:
      go_tarball: 'go1.11.2.linux-amd64.tar.gz'
      go_tarball_checksum: 'sha256:1dfe664fa3d8ad714bbd15a36627992effd150ddabd7523931f077b3926d736d'
      go_version_target: 'go version go1.11.2 linux/amd64'

      go_packages:
      - 'github.com/cumpsd/ccat'

  - name: Install Docker and Docker-compose
    include_role:
      name: docker
    vars:
      docker_edition: 'ce'
      docker_package_state: latest
      docker_apt_release_channel: edge
      docker_service_state: stopped
      docker_service_enabled: no
      docker_restart_handler_state: stopped
      docker_install_compose: True
      docker_compose_version: '1.23.1'
      docker_compose_path: /usr/local/bin/docker-compose
      docker_users: ['cumpsd']

  # - include_role:
  #     name: dotnet-core
  #   vars:
  #     dotnet_package: 'dotnet-sdk-2.1'

  - name: Setup NTP and configure timezone
    include_role:
      name: ntp
    vars:
      ntp_enabled: true
      ntp_timezone: Europe/Brussels

  - name: Install Packer
    include_role:
      name: packer
    vars:
      packer_version: '1.3.2'

  - name: Install Terraform
    include_role:
      name: terraform
    vars:
      terraform_ver : '0.11.10'
      terraform_platform : linux_amd64
      terraform_install_dir : /usr/local/bin
      terraform_checksums:
        '0.11.10':
          linux_amd64: sha256:43543a0e56e31b0952ea3623521917e060f2718ab06fe2b2d506cfaa14d54527

  - name: Install Consul
    include_role:
      name: consul-cli
    vars:
      consul_ver : '1.4.0'
      consul_platform : linux_amd64
      consul_install_dir : /usr/local/bin
      consul_checksums:
        '1.4.0':
          linux_amd64: sha256:41f8c3d63a18ef4e51372522c1e052618cdfcffa3d9f02dba0b50820e8279824

  - name: Install Nomad
    include_role:
      name: nomad-cli
    vars:
      nomad_ver : '0.8.6'
      nomad_platform : linux_amd64
      nomad_install_dir : /usr/local/bin
      nomad_checksums:
        '0.8.6':
          linux_amd64: sha256:7569561e4a8fdb283f36f9ff6ed7834be6b1f4a2149246f8bd3fb719265c800c

  - name: Install Vault
    include_role:
      name: vault-cli
    vars:
      vault_ver : '0.11.5'
      vault_platform : linux_amd64
      vault_install_dir : /usr/local/bin
      vault_checksums:
        '0.11.5':
          linux_amd64: sha256:5230377dd8c214b274261a1474ee484a43622cdfa162458311ef11bb8c31b5b8

  - name: Install Mono
    include_role:
      name: mono

  # - name: Install Polybar
  #   include_role:
  #     name: polybar

  # - name: Install VS Code
  #   include_role:
  #     name: visual-studio-code
