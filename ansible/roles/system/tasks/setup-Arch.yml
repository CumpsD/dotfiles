---
- name: Update pacman (pacman -Syu)
  become: yes
  pacman:
    update_cache: yes
    upgrade: yes

- name: Install basic command-line utilities
  pacman:
    name: [
        'curl',
        'gnupg',
        'htop',
        'wget',
        'unzip',
        'gzip',
        'bzip2',
        'dos2unix',
        'xloadimage']
    state: latest

- name: Install essential build tools
  pacman:
    name: [
        'intltool',
        'libtool',
        'ruby',
        'rubygems',
        'unixodbc',
        'python',
        'python-pip',
        'jdk-openjdk']
    state: latest

- name: Install essential build tools (AUR)
  aur:
    name: [
        'json-c ',
        'libsndfile1-dev']
    state: latest
    aur_only: yes

- name: Install Azure cli package
  package:
    name: azure-cli
    state: latest

- name: Install mssql-tools package
  package:
    name: mssql-tools
    state: latest
  environment:
    ACCEPT_EULA: "y"

- name: Install Ruby tools
  become: yes
  become_user: "{{ lookup('env','LOGNAME') }}"
  gem:
    name: "{{ item }}"
    state: latest
    user_install: yes
  with_items:
    - fpm
    - deb-s3
