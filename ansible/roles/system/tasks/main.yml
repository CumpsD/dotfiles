---
- name: Install Microsoft apt key
  become: yes
  apt_key:
    url: "https://packages.microsoft.com/keys/microsoft.asc"
    state: present

- name: Install Mono apt key
  apt_key:
    keyserver: keyserver.ubuntu.com
    id: "3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF"
    state: present

- name: Install Nodesource apt key
  apt_key:
    url: https://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=0x1655A0AB68576280
    id: "68576280"
    state: present

- name: Install Docker apt key
  apt_key:
    url: https://download.docker.com/linux/ubuntu/gpg
    id: "9DC858229FC7DD38854AE2D88D81803C0EBFCD88"
    state: present

- name: Install Fish apt key
  apt_key:
    keyserver: keyserver.ubuntu.com
    id: "59FDA1CE1B84B3FAD89366C027557F056DC33CA5"
    state: present

- name: Install Python apt key
  apt_key:
    keyserver: keyserver.ubuntu.com
    id: "4AB0F789CBA31744CC7DA76A8CF63AD3F06FC659"
    state: present

- name: Update all packages
  apt:
    upgrade: dist
    update_cache: yes
    autoclean: yes
    autoremove: yes

- name: Install basic command-line utilities
  apt:
    name: "{{ item }}"
    state: latest
  with_items:
    - curl
    - gnupg2
    - htop
    - wget
    - unzip
    - gzip
    - bzip2
    - dos2unix

- name: Install essential build tools
  apt:
    name: "{{ item }}"
    state: latest
  with_items:
    - build-essential
    - intltool
    - libtool
    - libsndfile1-dev
    - libjson-c-dev
    - ruby
    - ruby-dev
    - rubygems
    - unixodbc-dev
    - python3.6
    - python3-pip

- name: Install mssql-tools package
  package:
    name: mssql-tools
    state: latest
  environment:
    ACCEPT_EULA: "y"

- name: Install Ruby tools
  become: yes
  become_user: "{{ lookup('env','LOGNAME') }}"
  gem:
    name: "{{ item }}"
    state: latest
    user_install: yes
  with_items:
    - fpm
    - deb-s3
